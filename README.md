# 북클럽 3.0 통합검색 시스템

**프로젝트 상태**: 🟡 설계 완료 → 개발 착수 대기
**최종 업데이트**: 2025-02-10

---

## 📁 파일 구조

### 프로토타입 (HTML)
**파일**: `북클럽3.0_통합검색_프로토타입_v1.0.html`
- **목적**: 사용자 검색 UI 프로토타입
- **주요 기능**:
  - 🔍 실시간 검색 (초성, 오타 교정, 부분 일치)
  - 🤖 자동완성 (5개 제안)
  - 👶 KRS 레벨 기반 필터 토글
  - 📊 검색 결과 (KRS 부스팅 적용)
  - 🎯 제로 결과 대응 (추천 도서)
  - 🏷️ 장르 필터 및 정렬

**파일**: `북클럽3.0_통합검색_관리자_v1.0.html`
- **목적**: 관리자 검색 노출 관리 시스템
- **주요 기능**:
  - 📚 자재 검색 노출 관리 (auto/force_show/force_hide)
  - 📋 인덱싱 로그 모니터링
  - 📊 통계 대시보드 (검색 수, 성공률, 응답 시간)
  - 🔄 즉시 재인덱싱 트리거
  - ✅ 자동 노출 조건 체크 (메타데이터, 품질, 저작권)

---

## 📁 문서 구조

### 1. PRD (Product Requirements Document)
**파일**: `북클럽3.0_통합검색시스템_PRD_v1.0.md`
- **목적**: 비즈니스 요구사항 및 프로젝트 목표 정의
- **독자**: 기획자, 경영진, 프로젝트 관계자
- **내용**:
  - 프로젝트 배경 및 목적
  - 핵심 개편 요구사항 (전시 종속성 제거, 실시간 인덱싱, KRS 개인화)
  - 상세 기능 명세
  - 기술 아키텍처 제언
  - 기대 효과 및 구현 우선순위

### 2. 검토 의견서
**파일**: `북클럽3.0_통합검색시스템_PRD_검토의견_v1.0.md`
- **목적**: PRD에 대한 면밀한 분석 및 보완 사항 제시
- **독자**: 전체 프로젝트 팀
- **내용**:
  - 강점 분석
  - 개선 필요 사항 (검색 노출 정책, KRS 부스팅 등)
  - 추가 제안 사항 (접근성, 음성 검색 등)
  - Critical Path 및 리스크 관리
  - 최종 권장사항 (조건부 승인)

### 3. 상세 기술 설계서 ⭐
**파일**: `북클럽3.0_통합검색_기술설계서_v1.0.md`
- **목적**: 개발자 핸드오프를 위한 완전한 구현 가이드
- **독자**: Backend 개발자, DevOps 엔지니어, QA
- **내용**:
  - 검색 노출 정책 상세화 (불리언 로직, SQL, Python 구현)
  - BCMS 스키마 정의 (OpenSearch 매핑, Kafka 메시지)
  - PoC 기술 검증 포인트 (초성 검색, KRS 부스팅 테스트)
  - 장애 대응 시나리오 (재시도, Circuit Breaker, 롤백)
  - 구현 체크리스트 (6 Phase 로드맵)

---

## 🎯 프로젝트 개요

### 핵심 목표

**문제 인식:**
- 현재: CMS 전시 등록 자재만 검색 가능 (24시간 배치)
- 목표: BCMS 자재 직접 인덱싱 (1분 이내 실시간)

**Game Changer 3가지:**
1. ✅ **전시 종속성 완전 제거** - CMS → BCMS 직접 인덱싱
2. ⚡ **실시간 인덱싱 파이프라인** - Event-Driven (Kafka)
3. 🎨 **개인화 랭킹 엔진** - KRS 레벨 기반 부스팅

### 기술 스택

```
┌─────────────────────────────────────────┐
│ Frontend (검색 UI)                      │
├─────────────────────────────────────────┤
│ Search API (Node.js / Python)          │
├─────────────────────────────────────────┤
│ AWS OpenSearch v2.x                     │
│ - Nori 형태소 분석기                    │
│ - Ngram (부분 일치)                     │
│ - Chosung (초성 검색)                   │
├─────────────────────────────────────────┤
│ Indexer Service (Python)                │
├─────────────────────────────────────────┤
│ Kafka / AWS EventBridge                 │
├─────────────────────────────────────────┤
│ BCMS Database (RDS/Aurora)              │
└─────────────────────────────────────────┘
```

---

## 📊 구현 로드맵

### Phase 1: 인프라 구축 (1주)
- [ ] AWS OpenSearch 클러스터 (3 노드)
- [ ] Kafka/MSK 구성
- [ ] Indexer Service 배포 환경

### Phase 2: 데이터 파이프라인 (2주)
- [ ] BCMS DB 스키마 확정 (`search_visibility` 컬럼 추가)
- [ ] CDC 설정 (Debezium)
- [ ] Indexer Service 개발

### Phase 3: 검색 API 개발 (2주)
- [ ] 기본 검색 API
- [ ] KRS 부스팅 구현
- [ ] 자동완성 (Autocomplete)

### Phase 4: 관리자 페이지 (1주)
- [ ] 검색 노출 관리 UI
- [ ] 모니터링 대시보드 (Kibana)

### Phase 5: 테스트 및 배포 (2주)
- [ ] PoC 검증
- [ ] 부하 테스트 (1000 QPS)
- [ ] Canary 배포

### Phase 6: 운영 안정화 (지속)
- [ ] 알람 설정
- [ ] A/B 테스트
- [ ] 성능 최적화

**총 예상 기간**: 8주

---

## 🔑 핵심 의사결정 사항

### 즉시 필요한 결정

| 우선순위 | 항목 | 담당 | 마감 |
|---------|------|------|------|
| 🔴 P0 | 검색 노출 정책 확정 | 서비스 기획 | 1주 |
| 🔴 P0 | BCMS DB 스키마 확정 | BCMS 팀 | 1주 |
| 🔴 P0 | Kafka 인프라 결정 (MSK vs EC2) | 인프라팀 | 1주 |
| 🟡 P1 | KRS 부스팅 가중치 초기값 | 데이터 분석 | 2주 |
| 🟡 P1 | 동의어 사전 초기 데이터 | 콘텐츠 운영 | 2주 |

---

## 📈 기대 효과

### 정량적 효과

| 지표 | 현재 | 목표 | 개선율 |
|------|------|------|--------|
| 검색 반영 시간 | 평균 12시간 | 1분 이내 | **99.9%↓** |
| 검색 가능 자재 수 | ~5,000건 | ~20,000건 | **300%↑** |
| 검색 정확도 | 측정 미실시 | 80% 이상 | - |

### 정성적 효과

**사용자:**
- 🎯 원하는 콘텐츠 빠른 발견
- 🔍 오타/초성 검색 편의성
- 👶 아이 수준 맞춤 결과

**운영:**
- ⚙️ 전시-검색 분리로 프로세스 간소화
- 📊 데이터 기반 콘텐츠 기획
- 🚀 신규 콘텐츠 즉각 노출

**비즈니스:**
- 💰 콘텐츠 소비 증가
- 📈 사용자 만족도 향상
- 🎁 추천 시스템 고도화

---

## 🛠️ 개발자를 위한 빠른 시작

### 1. 문서 읽는 순서

```
1. PRD (전체 이해)
   ↓
2. 검토 의견 (주의사항 파악)
   ↓
3. 기술 설계서 (구현 방법)
   ↓
4. 코드 작성 시작
```

### 2. 즉시 실행 가능한 것들

**기술 설계서에서 복붙 가능:**
- ✅ OpenSearch 인덱스 매핑 (JSON)
- ✅ Indexer Service 코드 (Python 300줄)
- ✅ SQL 쿼리 (10개)
- ✅ 테스트 케이스 (8개)
- ✅ Circuit Breaker 구현

### 3. PoC 시작하기

```bash
# 1. OpenSearch 테스트 클러스터 생성
aws opensearch create-domain --domain-name bookclub-poc ...

# 2. 샘플 인덱스 생성
curl -X PUT "localhost:9200/bookclub_assets_v1" -H 'Content-Type: application/json' -d @index_mapping.json

# 3. 테스트 데이터 인덱싱
python indexer_service.py --mode=test --sample=1000

# 4. 초성 검색 테스트
curl -X POST "localhost:9200/bookclub_assets_v1/_search" -H 'Content-Type: application/json' -d @test_chosung.json
```

---

## 📞 문의 및 협업

### 문서 관련 질문
- **기획**: PRD, 검토 의견
- **기술**: 기술 설계서

### 다음 회의
- **일시**: 2025-02-15 (금) 14:00
- **안건**: PoC 결과 공유, 정책 확정, 상세 설계 리뷰
- **준비 자료**: PoC 테스트 리포트, 정책 문서 v1.0, API 스펙 초안

---

## 📝 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| v1.0 | 2025-02-10 | Claude | 초안 작성 (PRD, 검토의견, 기술설계서) |

---

**프로젝트 상태**: 🟢 Ready for Development
**다음 단계**: Phase 1 인프라 구축 착수
